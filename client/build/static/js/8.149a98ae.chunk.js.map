{"version":3,"sources":["views/api/api-edit/ApiEdit.tsx","utils/request.ts","components/spots/index.tsx","services/api.ts","utils/tools.ts"],"names":["Option","__webpack_exports__","antd_es_form__WEBPACK_IMPORTED_MODULE_3__","create","props","apiId","useParams","editorRef","useRef","_useState2","_slicedToArray","useState","_id","name","desc","url","options","method","params","response","delay","project","createTime","modifiedTime","api","setApi","_useState4","code","setCode","onFormat","e","id","current","trigger","handleSubmit","_ref","_asyncToGenerator","regeneratorRuntime","mark","_callee2","wrap","_context2","prev","next","preventDefault","form","validateFields","_ref2","_callee","err","fieldsValue","param","_context","JSON","parse","stripComment","t0","antd_es_message__WEBPACK_IMPORTED_MODULE_7__","error","abrupt","_objectSpread","concat","updateApi","sent","success","history","goBack","t1","stop","_x2","_x3","apply","this","arguments","_x","useEffect","_ref3","_callee3","rs","_context3","queryApi","stringify","query","setTimeout","getFieldDecorator","react__WEBPACK_IMPORTED_MODULE_10___default","a","createElement","className","components_spots__WEBPACK_IMPORTED_MODULE_13__","_extends","layout","onSubmit","Item","label","rules","required","message","pattern","initialValue","antd_es_input__WEBPACK_IMPORTED_MODULE_5__","maxLength","placeholder","antd_es_select__WEBPACK_IMPORTED_MODULE_9__","map","k","key","value","substring","addonBefore","addonAfter","type","antd_es_button__WEBPACK_IMPORTED_MODULE_1__","style","width","htmlType","onClick","react_monaco_editor__WEBPACK_IMPORTED_MODULE_12___default","height","language","theme","selectOnLineNumbers","onChange","newValue","editorWillMount","monaco","editorDidMount","focus","codeMessage","200","201","202","204","400","401","403","404","405","406","410","422","500","502","503","504","instance","axios","baseURL","timeout","headers","Content-Type","interceptors","request","use","config","Promise","reject","data","msg","antd_es_message__WEBPACK_IMPORTED_MODULE_3__","warning","status","antd_es_notification__WEBPACK_IMPORTED_MODULE_1__","placement","duration","description","path","newUrl","Object","keys","v","push","encodeURIComponent","paramStr","join","curConfig","react__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","react__WEBPACK_IMPORTED_MODULE_0___default","n","Spots","getRandomColor","r","Math","floor","random","g","b","getRandomTop","getRandomMargin","SpotsContent","useMemo","sArr","i","Fragment","radius","background","marginTop","marginLeft","top","left","apiCreate","res","deleteApi","_ref4","_callee4","_context4","_x4","source","replace","d"],"mappings":"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","file":"static/js/8.149a98ae.chunk.js","sourcesContent":["/* eslint-disable no-underscore-dangle */\n/* eslint-disable import/extensions */\n/* eslint-disable import/no-unresolved */\nimport React, { useState, useRef, useEffect } from 'react';\nimport { useParams } from 'react-router';\nimport { Form, Input, Button, message, Select } from 'antd';\nimport MonacoEditor, {\n  EditorWillMount,\n  ChangeHandler,\n  EditorDidMount,\n} from 'react-monaco-editor';\nimport { FormComponentProps } from 'antd/lib/form';\nimport Spots from 'components/spots';\nimport './index.less';\nimport { stripComment } from 'utils/tools';\nimport { editor } from 'monaco-editor';\nimport { queryApi, updateApi } from 'services/api';\nimport { Api } from 'typings/api';\n\nconst { Option } = Select;\n\ninterface FormProps extends FormComponentProps {\n  [propName: string]: any; // 要传进来的属性\n}\n\nfunction ApiEdit(props: any) {\n  const { apiId } = useParams();\n  const methods = ['get', 'post', 'put', 'delete', 'patch'];\n  const formItemLayout = {\n    // labelCol: {\n    //   xs: { span: 2 },\n    //   sm: { span: 3 },\n    // },\n    // wrapperCol: {\n    //   xs: { span: 4 },\n    //   sm: { span: 6 },\n    // },\n    // colon: false,\n  };\n\n  const initApi = {\n    _id: '',\n    name: '',\n    desc: '',\n    url: '',\n    options: {\n      method: '',\n      params: '',\n      response: '{}',\n      delay: 0,\n    },\n    project: '',\n    createTime: 0,\n    modifiedTime: 0,\n  };\n\n  // 保存编辑器实例\n  const editorRef = useRef<editor.IStandaloneCodeEditor | null>(null);\n\n  const options = {\n    selectOnLineNumbers: true,\n  };\n\n  const [api, setApi] = useState<Api>(initApi);\n\n  const [code, setCode] = useState('');\n\n  const trigger = (e: editor.IStandaloneCodeEditor, id: string) => {\n    console.log(e, 'meditor');\n    if (!e) return;\n    console.log('onFormataaa');\n    e.trigger('anyString', id, null);\n  };\n\n  // 格式化代码\n  const onFormat = () => {\n    if (editorRef.current) {\n      trigger(editorRef.current, 'editor.action.formatDocument');\n    }\n  };\n\n  const editorDidMount: EditorDidMount = (e, monaco) => {\n    console.log('editorDidMount', e);\n    console.log('monaco', monaco);\n    e.focus();\n    e.layout();\n    editorRef.current = e;\n    setTimeout(() => {\n      e.layout();\n      editorRef.current = e;\n      // const model = editor.getModel();\n      // if (model) {\n      //   console.log(model.getValue(), 'model.getValue()');\n      //   // console.log(JSON.parse(model.getValue()));\n      // }\n    }, 100);\n  };\n  const editorWillMount: EditorWillMount = monaco => {\n    console.log('editorWillMount', monaco);\n  };\n  const onChange: ChangeHandler = (newValue, e) => {\n    console.log('onChange', newValue, e);\n    // console.log(stripComment(newValue));\n    setCode(newValue);\n  };\n\n  const handleSubmit = async (e: { preventDefault: () => void }) => {\n    e.preventDefault();\n    props.form.validateFields(async (err: any, fieldsValue: any) => {\n      if (!err) {\n        console.log(fieldsValue);\n        const { name, method, desc, url, delay } = fieldsValue;\n        let response;\n        try {\n          response = JSON.parse(stripComment(code) || '{}');\n          console.log(JSON.parse(stripComment(code) || '{}'), 'code');\n        } catch (error) {\n          console.log(error);\n          message.error('mock 数据有错误，请检查修改后再次创建');\n          return;\n        }\n        const param = {\n          ...api,\n          name,\n          desc: desc || '',\n          url: `/${url}`,\n          options: {\n            method,\n            params: {},\n            response,\n            delay,\n          },\n        };\n        console.log(param, 'param');\n        try {\n          const rs = await updateApi(param);\n          if (rs) {\n            message.success('接口保存成功');\n            props.history.goBack();\n          }\n        } catch (error) {\n          console.log(error);\n        }\n      }\n    });\n  };\n\n  useEffect(() => {\n    const query = async () => {\n      if (!apiId) return;\n      try {\n        const rs = await queryApi({ apiId: apiId as string });\n        if (rs) {\n          setCode(JSON.stringify(rs.options.response));\n          setApi(rs);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    query();\n  }, [apiId]);\n\n  useEffect(() => {\n    if (!api._id) return;\n    setTimeout(() => {\n      onFormat();\n    }, 100);\n    setTimeout(() => {\n      onFormat();\n    }, 160);\n    setTimeout(() => {\n      onFormat();\n    }, 500);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [api._id]);\n\n  const { getFieldDecorator } = props.form;\n\n  return (\n    <div className=\"api-create\">\n      <div className=\"api-create-side\">\n        <Spots />\n        <div className=\"header-info\">\n          <h2>编辑接口</h2>\n          <p>(╯‵□′)╯︵┻━┻</p>\n        </div>\n        <Form\n          layout=\"vertical\"\n          onSubmit={handleSubmit}\n          {...formItemLayout}\n          className=\"api-create-form\"\n        >\n          <Form.Item label=\"接口名称\">\n            {getFieldDecorator('name', {\n              rules: [\n                {\n                  required: true,\n                  message: '名称不能为空',\n                },\n                {\n                  pattern: /^[\\u4e00-\\u9fa5a-zA-Z0-9\\-_.]{0,30}$/,\n                  message:\n                    '仅支持汉字、英文字母、数字、下划线(_)、连字符(-)、点(.)',\n                },\n              ],\n              initialValue: api.name,\n            })(<Input maxLength={30} placeholder=\"\" />)}\n          </Form.Item>\n          <Form.Item label=\"方法\">\n            {getFieldDecorator('method', {\n              rules: [\n                {\n                  required: true,\n                },\n              ],\n              initialValue: api.options.method,\n            })(\n              <Select>\n                {methods.map((k: string) => (\n                  <Option key={k} value={k}>\n                    {k}\n                  </Option>\n                ))}\n              </Select>\n            )}\n          </Form.Item>\n          <Form.Item label=\"URL\">\n            {getFieldDecorator('url', {\n              rules: [\n                {\n                  required: true,\n                  message: 'URL不能为空',\n                },\n                {\n                  pattern: /^[a-zA-Z-_/]*$/,\n                  message: '格式为大小写英文字母、/、-、_',\n                },\n              ],\n              initialValue: api.url.substring(1),\n            })(<Input addonBefore=\"/\" maxLength={60} placeholder=\"\" />)}\n          </Form.Item>\n          <Form.Item label=\"接口返回延时\">\n            {getFieldDecorator('delay', {\n              rules: [\n                {\n                  required: true,\n                  message: '延时不能为空',\n                },\n                {\n                  pattern: /^(0|[1-9][0-9]*)$/,\n                  message: '延时为正整数',\n                },\n              ],\n              initialValue: api.options.delay,\n            })(\n              <Input\n                addonAfter=\"ms\"\n                type=\"number\"\n                maxLength={8}\n                placeholder=\"\"\n              />\n            )}\n          </Form.Item>\n          <Form.Item label=\"接口描述\">\n            {getFieldDecorator('desc', {\n              initialValue: api.desc,\n            })(<Input maxLength={255} placeholder=\"\" />)}\n          </Form.Item>\n          <Form.Item className=\"ta-c\">\n            <Button style={{ width: '100%' }} type=\"primary\" htmlType=\"submit\">\n              保存\n            </Button>\n          </Form.Item>\n        </Form>\n        <div className=\"side-btn\">\n          <Button type=\"primary\" onClick={onFormat}>\n            格式化\n          </Button>\n          <Button\n            type=\"primary\"\n            onClick={() => {\n              props.history.goBack();\n            }}\n          >\n            返回\n          </Button>\n        </div>\n      </div>\n      <div className=\"api-create-main\">\n        <MonacoEditor\n          width=\"100%\"\n          height=\"100%\"\n          language=\"json\"\n          theme=\"vs\"\n          value={code}\n          options={options}\n          onChange={onChange}\n          editorWillMount={editorWillMount}\n          editorDidMount={editorDidMount}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default Form.create<FormProps>({})(ApiEdit);\n","import axios, { AxiosRequestConfig } from 'axios';\nimport { message, notification } from 'antd';\n\ntype Response<T> = {\n  [P in keyof T]: T[P];\n} & { code: number | string };\n\n// HTTP code码\nconst codeMessage: { [key: string]: string } = {\n  200: '服务器成功返回请求的数据。',\n  201: '无数据',\n  202: '一个请求已经进入后台排队（异步任务）。',\n  204: '删除数据成功。',\n  400: '发出的请求有错误，服务器没有进行新建或修改数据的操作。',\n  401: '用户没有权限（令牌、用户名、密码错误）。',\n  403: '用户没有访问权限',\n  404: '发出的请求针对的是不存在的记录，服务器没有进行操作。',\n  405: '方法不被允许',\n  406: '请求的格式不可得。',\n  410: '请求的资源被永久删除，且不会再得到的。',\n  422: '当创建一个对象时，发生一个验证错误。',\n  500: '服务器发生错误，请检查服务器。',\n  502: '网关错误。',\n  503: '服务不可用，服务器暂时过载或维护。',\n  504: '网关超时。',\n};\n\nconst getBaseUrl = () => {\n  if (process.env.NODE_ENV === 'development') {\n    // 如果在开发环境的时候可以用于本地联调\n    // return 'http://localhost:1988';\n  }\n  return '';\n};\n\n// 新创建一个axios实例，并进行基础配置\nconst instance = axios.create({\n  baseURL: getBaseUrl(),\n  timeout: 10000,\n  headers: {\n    'Content-Type': 'application/json',\n    // \"Content-Type\":\"application/x-www-form-urlencoded;charset=utf-8\"\n  },\n});\n\n// 添加请求拦截器\ninstance.interceptors.request.use(\n  config => {\n    // 再次设置token或者添加loading等请求前的操作\n    // 添加一个loading\n    // store.dispatch(actions.showLoading(true));\n    return config;\n  },\n  error => {\n    return Promise.reject(error);\n  }\n);\n\n// 添加xi响应拦截器\ninstance.interceptors.response.use(\n  response => {\n    // 响应数据后做点什么\n    // 添加一个loading\n    // store.dispatch(actions.showLoading(false));\n    // 存在业务异常 抛出给业务代码去捕获\n    const { data } = response;\n    if (data.code != 200) {\n      const msg = data.msg || data.message || '';\n      message.warning(msg);\n      return Promise.reject(data);\n    }\n    // 不存在业务异常返回数据\n    return data;\n  },\n  error => {\n    if (error && error.response) {\n      const { status } = error.response;\n      console.warn(\n        `http error: status-${status} message-${codeMessage[status]}`\n      );\n\n      if (codeMessage[status] !== null || undefined) {\n        notification.warning({\n          placement: 'topRight',\n          duration: 2,\n          message: '提示',\n          description: `接口：${error.response.data.path}，${error.response.data.message}`,\n        });\n      } else {\n        notification.warning({\n          placement: 'topRight',\n          duration: 2,\n          message: '提示',\n          description: error,\n        });\n      }\n    }\n    return Promise.reject(error); // 非业务异常无需抛出错误 内部吞掉\n  }\n);\n\n/**\n * get请求\n * @method get\n * @param {url, params, loading} 请求地址，请求参数，是否需要加载层\n */\nconst get = (url: string, params: any) => {\n  return new Promise((resolve, reject) => {\n    // {\n    //   params: params\n    // }\n    instance\n      .get(url, params)\n      .then(res => {\n        resolve(res);\n      })\n      ['catch'](err => {\n        reject(err);\n      });\n  });\n};\n/**\n * post请求\n * @method post\n * @param {url, params} 请求地址，请求参数，是否需要加载层\n */\nconst post = (url: string, data: any) => {\n  return new Promise((resolve, reject) => {\n    // qs.stringify(data)\n    instance\n      .post(url, data)\n      .then(res => {\n        console.log(res);\n        resolve(res);\n      })\n      ['catch'](err => {\n        reject(err);\n      });\n  });\n};\n\nfunction request<T>(config: AxiosRequestConfig): Promise<Response<T>> | null {\n  let newUrl = config.url;\n  if (\n    (config.method === 'GET' ||\n      config.method === 'DELETE' ||\n      config.method === 'PUT') &&\n    config.data\n  ) {\n    const param: string[] = [];\n    Object.keys(config.data).map((v: string, k: number) => {\n      param.push(`${v}=${encodeURIComponent(config.data[v])}`);\n    });\n    const paramStr = param.join('&');\n    newUrl = `${newUrl}?${paramStr}`;\n  }\n  const curConfig = { ...config, url: newUrl };\n  return (instance.request<Response<T>>(curConfig) as any) as Promise<\n    Response<T>\n  >;\n}\nexport { get, post, request, Response };\n","import React, { useMemo } from 'react';\nimport './index.less';\n\nfunction Spots(props: any) {\n  const NUM = 10;\n  const getRandomColor = () => {\n    const r = Math.floor(Math.random() * 100) + 155;\n    const g = Math.floor(Math.random() * 100) + 115;\n    const b = Math.floor(Math.random() * 100) + 115;\n    return `rgb(${r},${g},${b})`;\n  };\n  const getRandomWidth = () => {\n    return Math.floor(Math.random() * 60);\n  };\n  const getRandomTop = () => {\n    return `${Math.floor(Math.random() * 100)}%`;\n  };\n  const getRandomMargin = () => {\n    return `-${Math.floor(Math.random() * 60)}px`;\n  };\n\n  const SpotsContent = useMemo(() => {\n    const sArr: number[] = [];\n    for (let i = 0; i < NUM; i++) {\n      sArr.push(i);\n    }\n    return (\n      <>\n        {sArr.map(k => {\n          const radius = getRandomWidth();\n          return (\n            <span\n              key={k}\n              className=\"decorate\"\n              style={{\n                background: getRandomColor(),\n                width: radius,\n                height: radius,\n                marginTop: getRandomMargin(),\n                marginLeft: getRandomMargin(),\n                top: getRandomTop(),\n                left: getRandomTop(),\n              }}\n            />\n          );\n        })}\n      </>\n    );\n  }, []);\n\n  return <div className=\"spots\">{SpotsContent}</div>;\n}\n\nexport default Spots;\n","import { Api } from 'typings/api';\nimport { request, Response } from '../utils/request';\n\ninterface RequestResponse {\n  code: number;\n  message: string;\n  // success: boolean;\n  data: any;\n}\n\n// 接口创建\nexport const apiCreate = async (params: Partial<Api>) => {\n  const res = await request<Response<RequestResponse>>({\n    url: '/api/create',\n    method: 'POST',\n    data: params,\n  });\n  return res && res.data;\n};\n\n// 接口查询\nexport const queryApi = async (params: { apiId: string }) => {\n  const res = await request<Response<RequestResponse>>({\n    url: '/api/query',\n    method: 'GET',\n    data: params,\n  });\n  return res && res.data;\n};\n\n// 接口更新\nexport const updateApi = async (params: Api) => {\n  const res = await request<Response<RequestResponse>>({\n    url: '/api/update',\n    method: 'POST',\n    data: params,\n  });\n  return res && res.data;\n};\n\n// 接口删除\nexport const deleteApi = async (params: { apiId: string }) => {\n  const res = await request<Response<RequestResponse>>({\n    url: '/api/delete',\n    method: 'DELETE',\n    data: params,\n  });\n  return res && res.data;\n};\n","// 事件触发函数\nexport function triggerEvent(el: Element | Window, type: string) {\n  if ('createEvent' in document) {\n    // modern browsers, IE9+\n    const e = document.createEvent('HTMLEvents');\n    e.initEvent(type, false, true);\n    el.dispatchEvent(e);\n  }\n}\n\nexport function stripComment(source: string): string {\n  const reg = /((?<!:)\\/\\/.*)|(\\/\\*[\\s\\S]*?\\*\\/)/g;\n  return source == null ? '' : source.replace(reg, '');\n}\n"],"sourceRoot":""}